<!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-spring4-4.dtd">
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorator="layout">
<head>
    <title>Dashboard</title>
    <style type="text/css">
 
.dataTables_scrollHeadInner {
width: 5000px;
}
    </style>
</head>
<body>
<section layout:fragment="header">
    <h1>Dashboard</h1>
<ol class="breadcrumb">
    <li class="active">Dashboard</li>
</ol>
</section>
<div layout:fragment="content">
    <div class="box" >
        <div class="box-body no-padding">
        
 <!-- <form role="form"  th:object="${reportSelector}" th:action="@{/reports/monthWiseReport}" method="get" name="myForm" id="myForm"> -->
 <div class="table-responsive">
                   <table id="example" class="table  table-bordered dt-responsive nowrap" width="100%">
                       <thead>	
                 <tr>
                 <th colspan=5></th>
                 <th colspan=2 style="background-color:#00aad1;">April</th>
                 <th colspan=2>May</th>
                 <th colspan=2 style="background-color:#00aad1;">June</th>
                 <th colspan=2>July</th>
                 <th colspan=2 style="background-color:#00aad1;">August</th>
                 <th colspan=2>September</th>
                 <th colspan=2 style="background-color:#00aad1;">October</th>
                 <th colspan=2>November</th>
                 <th colspan=2 style="background-color:#00aad1;">December</th>
                 <th colspan=2>January</th>
                 <th colspan=2 style="background-color:#00aad1;">February</th>
                 <th colspan=2>March</th>
               <th colspan=2 style="background-color:#00aad1;"> MeetsDone</th>
                 <!--   <th colspan=2>Received Data</th>-->
                 <th colspan=2>Pending Reports</th> 
                 <th colspan=2 style="background-color:#00aad1;">Plumber Attended Meets</th> 
                 <th colspan=2>Gifts SentTill date</th> 
                 <th colspan=2 style="background-color:#00aad1;">Unutilised Gifts</th>
                 
                 </tr>      		
                <tr>
                    <th>Zone</th>
                    <th>Area</th>
                    <th>Emp Code</th>
                    <th>Emp Name</th>
                    <th>TBH/ABH</th>
                    <th style="background-color:#00aad1;">TPM</th>
                    <th style="background-color:#00aad1;">TPS</th>
                   <th>TPM</th>
                    <th>TPS</th>
                    <th style="background-color:#00aad1;">TPM</th>
                    <th style="background-color:#00aad1;">TPS</th>
                    <th>TPM</th>
                    <th>TPS</th>
                    <th style="background-color:#00aad1;">TPM</th>
                    <th style="background-color:#00aad1;">TPS</th>
                    <th>TPM</th>
                    <th>TPS</th>
                    <th style="background-color:#00aad1;">TPM</th>
                    <th style="background-color:#00aad1;">TPS</th>
                    <th>TPM</th>
                    <th>TPS</th>
                    <th style="background-color:#00aad1;">TPM</th>
                    <th style="background-color:#00aad1;">TPS</th>
                    <th>TPM</th>
                    <th>TPS</th>
                    <th style="background-color:#00aad1;">TPM</th>
                    <th style="background-color:#00aad1;">TPS</th>
                    <th>TPM</th>
                    <th>TPS</th>     
                     <th style="background-color:#00aad1;">TPM</th>
                    <th style="background-color:#00aad1;">TPS</th>
                     <th>TPM</th>
                    <th>TPS</th>
                    <th style="background-color:#00aad1;">TPM</th>
                    <th style="background-color:#00aad1;">TPS</th>
                    <th>TPM</th>
                    <th>TPS</th>     
                     <th style="background-color:#00aad1;">TPM</th>
                    <th style="background-color:#00aad1;">TPS</th>
                </tr>
                    </thead>
           		<tbody>
           		<tr th:each="row:${overallRepLt}">
        		
        		<td th:text="${row.zone}"></td>
        		<td th:text="${row.Area}"></td>
        		<td th:text="${row.empCode}"></td>
        		<td th:text="${row.empName}"></td>
        		<td th:text="${row.empRole}"></td>
        		<td th:styleappend="'background-color: ' + ${row.aprTPMBGC} + ';'" th:text="${row.aprTPM}"></td>
        		<td th:styleappend="'background-color: ' + ${row.aprTPSBGC} + ';'" th:text="${row.aprTPS}"></td>
        		<td th:styleappend="'background-color: ' + ${row.mayTPMBGC} + ';'"th:text="${row.mayTPM}"></td>
        		<td th:styleappend="'background-color: ' + ${row.mayTPSBGC} + ';'"th:text="${row.mayTPS}"></td>
				<td th:styleappend="'background-color: ' + ${row.junTPMBGC} + ';'" th:text="${row.junTPM}"></td>
				<td th:styleappend="'background-color: ' + ${row.junTPSBGC} + ';'"th:text="${row.junTPS}"></td>
				<td th:styleappend="'background-color: ' + ${row.julTPMBGC} + ';'" th:text="${row.julyTPM}"></td>
				<td th:styleappend="'background-color: ' + ${row.julTPSBGC} + ';'" th:text="${row.julyTPS}"></td>
				<td th:styleappend="'background-color: ' + ${row.augTPMBGC} + ';'" th:text="${row.augTPM}"></td>
				<td th:styleappend="'background-color: ' + ${row.augTPSBGC} + ';'" th:text="${row.augTPS}"></td>
				<td th:styleappend="'background-color: ' + ${row.sepTPMBGC} + ';'" th:text="${row.sepTPM}"></td>
        		<td th:styleappend="'background-color: ' + ${row.sepTPSBGC} + ';'" th:text="${row.sepTPS}"></td>
        		<td th:styleappend="'background-color: ' + ${row.octTPMBGC} + ';'" th:text="${row.octTPM}"></td>
				<td th:styleappend="'background-color: ' + ${row.octTPSBGC} + ';'" th:text="${row.octTPS}"></td>
				<td th:styleappend="'background-color: ' + ${row.novTPMBGC} + ';'" th:text="${row.novTPM}"></td>
				<td th:styleappend="'background-color: ' + ${row.novTPSBGC} + ';'" th:text="${row.novTPS}"></td>
				<td th:styleappend="'background-color: ' + ${row.decTPMBGC} + ';'" th:text="${row.decTPM}"></td>
	     		<td th:styleappend="'background-color: ' + ${row.decTPSBGC} + ';'" th:text="${row.decTPS}"></td>
	     		<td th:styleappend="'background-color: ' + ${row.janTPMBGC} + ';'" th:text="${row.janTPM}"></td>
	     		<td th:styleappend="'background-color: ' + ${row.janTPSBGC} + ';'" th:text="${row.janTPS}"></td>
	     		<td th:styleappend="'background-color: ' + ${row.febTPMBGC} + ';'" th:text="${row.febTPM}"></td>
	     		<td th:styleappend="'background-color: ' + ${row.febTPSBGC} + ';'" th:text="${row.febTPS}"></td>
	     		<td th:styleappend="'background-color: ' + ${row.marTPMBGC} + ';'" th:text="${row.marTPM}"></td>
	     		<td th:styleappend="'background-color: ' + ${row.marTPSBGC} + ';'" th:text="${row.marTPS}"></td>
	     		<td th:styleappend="'background-color: ' + ${row.meetsDoneTPMBGC} + ';'" th:text="${row.meetsDoneTPM}"></td>
	     		<td th:styleappend="'background-color: ' + ${row.meetsDoneTPSBGC} + ';'" th:text="${row.meetsDoneTPS}"></td>
	     		<td th:styleappend="'background-color: ' + ${row.inProcessTPMBGC} + ';'"th:text="${row.inProcessTPM}"></td>
	     		<td th:styleappend="'background-color: ' + ${row.inProcessTPSBGC} + ';'"th:text="${row.inProcessTPS}"></td>
	     		<td th:styleappend="'background-color: ' + ${row.noOFPlumTPMBGC} + ';'"th:text="${row.noOFPlumTPM}"></td>
	     		<td th:styleappend="'background-color: ' + ${row.noOFPlumTPSBGC} + ';'"th:text="${row.noOFPlumTPS}"></td>
	     		<td th:styleappend="'background-color: ' + ${row.usedQtyTPMBGC} + ';'"th:text="${row.usedQtyTPM}"></td>
	     		<td th:styleappend="'background-color: ' + ${row.usedQtyTPSBGC} + ';'"th:text="${row.usedQtyTPS}"></td>
	     		<td th:styleappend="'background-color: ' + ${row.leftQtyTPMBGC} + ';'"th:text="${row.leftQtyTPM}"></td>
	     		<td th:styleappend="'background-color: ' + ${row.leftQtyTPSBGC} + ';'"th:text="${row.leftQtyTPS}"></td>
	     		
           		
           		</tr>
           		</tbody>	
                   </table>
                   </div>
                   <a style="margin-left: 25%;margin-bottom: 10px;margin-top: 10px;" href="#" onclick="fnExcelReport();" class="btn btn-success"><span class="glyphicon glyphicon-save"></span>DOWNLOAD EXCEL</a>
                   
        </div>
    </div>

</div>
<iframe id="txtArea1" style="display:none"></iframe>
<div layout:fragment="scriptContent">
<script language="javascript" type="text/javascript">  
    var table3Filters = {  
        col_0: "select", 
        col_1: "select",
        col_2: "select",
        col_3: "select",
        col_4: "select",
        col_5: "none",
        col_6: "none",
        col_7: "none",
        col_8: "none",
        col_9: "none",
        col_10: "none",
        col_11: "none",
        col_12:"none",
        col_13: "none",
        col_14: "none",
        col_15: "none",
        col_16: "none",
        col_17: "none",
        col_18: "none",
        col_19: "none",
        col_20: "none",
        col_21: "none",
        col_22: "none",
        col_23: "none",
        col_24: "none",
        col_25: "none",
        col_26: "none",
        col_27: "none",
        col_28: "none",
        col_29: "none",
        col_30: "none",
        col_31: "none",
        col_32: "none",
        col_33: "none",
        col_34: "none", 
        col_35: "none",
        col_36: "none",
        col_37: "none",
        col_38: "none",
        col_39: "none",
        btn: true  
    } ; 
    var tf03 = setFilterGrid("example",2,table3Filters);  

   
</script>  
<script type="text/javascript">
$(document).ready(function() {
		
		/*$('#example').DataTable({
					
		//	"dom": 'T<"clear">lfrtip',
			   //"scrollY":        '500px',
		        "scrollX":        'true'
		       // "scrollCollapse": 'true',
		        //"paging":         'false',
		        /*"fixedColumns":   {
		            "leftColumns": 1
		            
		           }
			
	
		});*/
	
});
function fnExcelReport()
{
    var tab_text="<table border='2px'><tr bgcolor='#87AFC6'>";
    var textRange; var j=0;
    tab = document.getElementById('example'); // id of table

    for(j = 0 ; j < tab.rows.length ; j++) 
    {     
        tab_text=tab_text+tab.rows[j].innerHTML+"</tr>";
        //tab_text=tab_text+"</tr>";
    }

    tab_text=tab_text+"</table>";
    tab_text= tab_text.replace(/<A[^>]*>|<\/A>/g, "");//remove if u want links in your table
    tab_text= tab_text.replace(/<img[^>]*>/gi,""); // remove if u want images in your table
    tab_text= tab_text.replace(/<input[^>]*>|<\/input>/gi, ""); // reomves input params

    var ua = window.navigator.userAgent;
    var msie = ua.indexOf("MSIE "); 

    if (msie > 0 || !!navigator.userAgent.match(/Trident.*rv\:11\./))      // If Internet Explorer
    {
        txtArea1.document.open("txt/html","replace");
        txtArea1.document.write(tab_text);
        txtArea1.document.close();
        txtArea1.focus(); 
        sa=txtArea1.document.execCommand("SaveAs",true,"Report.xls");
    }  
    else                 //other browser not tested on IE 11
        sa = window.open('data:application/vnd.ms-excel,' + encodeURIComponent(tab_text));  

    return (sa);
}
</script>


</div>

</body>
</html>